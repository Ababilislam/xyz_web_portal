{{extend 'layout.html'}}
<script src="https://code.jquery.com/jquery-3.2.1.min.js"></script>
<script src="https://code.jquery.com/ui/1.13.3/jquery-ui.min.js"></script>
                            
<script>
    var base_url=location.protocol + "//" + location.hostname + (location.port && ":" + location.port) + "/{{=request.application}}/";
    // console.log(base_url);
    $(function () {

        // alert(base_url + 'user_item/get_all_item_list')
        $.ajax({
            url: base_url + 'user_item/get_all_order_list',
            success: function (resStr) {
                valuelvlListStr_sm = resStr
            }
        });
    
        $('#item_id_filter').keyup(function () {
            //-------------------------
            var valueList = valuelvlListStr_sm.split(',');
            var searchValue = $("#item_id_filter").val();

            //---------------- auto complete combo list
            var valueList_new = new Array();
            lc = 0;
            i = 0;
            var valueStr = "";
            while (i < valueList.length) {
                valueStr = valueList[i];
                i = i + 1;
                var res = valueStr.toUpperCase().match(searchValue.toUpperCase());
                if (res != null) {
                    valueList_new[lc] = valueStr;
                    lc = lc + 1;
                    if (lc == 30) {
                        break;
                    };
                } else {
                    continue;
                }
            };
            //alert (ref_list_new);
            //-------------- auto complete source
            $("input#item_id_filter").autocomplete({
                source: valueList_new
            });

        });
    });
</script>
<!-- script for auto complete -->
<script>
    var base_url=location.protocol + "//" + location.hostname + (location.port && ":" + location.port) + "/{{=request.application}}/";
    // console.log(base_url);
    $(function () {

        // alert(base_url + 'order/get_mobile_list')
        $.ajax({
            url: base_url + 'order/get_mobile_list',
            success: function (resStr) {
                valueList_mobile = resStr
                // alert(valuelvlListStr_sm)
            }
        });
    
        $('#search_mobile').keyup(function () {
            //-------------------------
            
            var valueList_m = valueList_mobile.split(',');
            var searchValue_m = $("#search_mobile").val();


            //---------------- auto complete combo list
            var valueList_mob = new Array();
            lc = 0;
            i = 0;
            var value_m_Str = "";
            while (i < valueList_m.length) {
                value_m_Str = valueList_m[i];
                i = i + 1;
                console.log(searchValue_m);
                var res = value_m_Str.toUpperCase().match(searchValue_m.toUpperCase());
                console.log(res);
                if (res != null) {
                    valueList_mob[lc] = value_m_Str;
                    lc = lc + 1;
                    if (lc == 30) {
                        break;
                    };
                } else {
                    continue;
                }
            };
            //alert (ref_list_new);
            //-------------- auto complete source
            $("input#search_mobile").autocomplete({
                source: valueList_mob
            });

        });
    });
</script>
<script>
    var base_url=location.protocol + "//" + location.hostname + (location.port && ":" + location.port) + "/{{=request.application}}/";
    // console.log(base_url);
    $(function () {
        // alert(base_url + 'order/get_client_list')
        $.ajax({
            url: base_url + 'order/get_client_list',
            success: function (resStr) {
                valuelvlListStr_sm = resStr
                // alert(valuelvlListStr_sm)
            }
        });
    
        $('#search_name').keyup(function () {
            //-------------------------
            var valueList = valuelvlListStr_sm.split(',');
            var searchValue = $("#search_name").val();

            //---------------- auto complete combo list
            var valueList_new = new Array();
            lc = 0;
            i = 0;
            var valueStr = "";
            while (i < valueList.length) {
                valueStr = valueList[i];
                i = i + 1;
                var res = valueStr.toUpperCase().match(searchValue.toUpperCase());
                if (res != null) {
                    valueList_new[lc] = valueStr;
                    lc = lc + 1;
                    if (lc == 30) {
                        break;
                    };
                } else {
                    continue;
                }
            };
            //alert (ref_list_new);
            //-------------- auto complete source
            $("input#search_name").autocomplete({
                source: valueList_new
            });

        });
    });
</script>

<!-- data picker -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-datepicker/1.9.0/css/bootstrap-datepicker.min.css">
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-datepicker/1.9.0/js/bootstrap-datepicker.min.js"></script>

<!-- <script>
    $(document).ready(function() {
        $('#order_date').datepicker({
            format: 'yyyy/mm/dd', // Set the format to YYYY/MM/DD
            autoclose: true, // Close the picker after selecting a date
            todayHighlight: true // Highlight today's date
        });
    });
</script> -->
<script>
    $(document).ready(function() {
        $('#order_date').datepicker({
            dateFormat: 'yy-mm-dd', // Correct format setting for jQuery UI Datepicker
            autoclose: true, // Close the picker after selecting a date
            todayHighlight: true // Highlight today's date (not a direct option in jQuery UI, use CSS instead)
        });
    });
</script>

<table width="100%"  border="0" cellspacing="0" cellpadding="0" style="background-color:#FFFFFF;" >
  <tr height="30px" >
    <td width="280px"><span class="blackCatTitle">Order
      
    </span></td>
   
    <td width="10px"></td>
    <td align="right" width="20px">&nbsp;</td>
  </tr>
  <tr  height="1px" style="background-color:#CCCCCC;">
	    <td ></td><td ></td>
	    <td width="100" ></td>
	    <td ></td>
  </tr>
</table>


<table width="100%" height="500px"  border="0" cellspacing="0" cellpadding="0" class="page_color"  >
    <tr height="100%"  style="vertical-align:top;">
        <td>
            <table width="100%"  border="0" cellpadding="0" cellspacing="0"  >
                <tr>
                    <td width="10">&nbsp;</td>
                    <td valign="top">
                        <br />

          <!--=====INPUT VALUES===========-->
                       
                        <!--=======FILTER/ALL/DOWNLOAD/BATCHUP==========-->
                        <table width="80%" cellpadding="1" cellspacing="1" class="sample_border" >
		   
                            <form id="form1" name="form1" method="post" action="{{=URL(c='order',f='order')}}" >
                             <tr align="left" class="blackCatHead"  height="20px" ;"vertical-align:middle">
                                 
                                <td width="50" >
                                    {{if session.order_date == '' or session.order_date == 'None' or session.order_date == None :}}
                                    <input class="date"  type="text" name="order_date" id="order_date" autocomplete="off" placeholder="Order Date" style="width:150px;">

                                    {{else:}}
                                        <input  class="date" type="text" name="order_date" id="order_date" value="{{=session.order_date}}" placeholder="Order Date" autocomplete="off" style="width:150px"/>
                                   {{pass}}                                   
                                </td>
                                
                               
                                
                                <td width="80" >
                                    {{if session.search_sl == '' or session.search_sl == 'None' or session.search_sl == None :}}
                                    <input  name="search_sl" type="text" id="search_sl" placeholder="SL" autocomplete="off" style="width:80px"/>

                                    {{else:}}
                                    <input  name="search_sl" type="text" id="search_sl" value="{{=session.search_sl}}" autocomplete="off" style="width:80px"/>
                                   {{pass}}                                       
                                </td>

                                <td width="100" >
                                    {{if session.search_name == '' or session.search_name == 'None' or session.search_name == None :}}
                                    <input  name="search_name" type="text" id="search_name" placeholder="Name" autocomplete="off" style="width:150px"/>

                                    {{else:}}
                                    <input  name="search_name" type="text" id="search_name" value="{{=session.search_name}}" autocomplete="off" style="width:150px"/>
                                   {{pass}}                                      
                                </td>

                                <td width="100" >
                                    {{if session.search_mobile == '' or session.search_mobile == 'None' or session.search_mobile == None :}}
                                    <input  name="search_mobile" type="text" id="search_mobile" placeholder="Mobile No" autocomplete="off" style="width:120px"/>

                                    {{else:}}
                                    <input  name="search_mobile" type="text" id="search_mobile" value="{{=session.search_mobile}}" autocomplete="off" style="width:120px"/>
                                   {{pass}}                                       
                                </td>

                                <td width="100">
                                    {{if session.search_status == '' or session.search_status == 'None' or session.search_status == None :}}
                                    <select name="search_status" id="search_status" style="width:100px;height: 30px;">
                                        <option selected value="">Status</option>
                                        <option value="Draft">Draft</option>
                                        <option value="Submitted">Submitted</option>
                                        <option value="Cancel">Cancel</option>
                                    </select>
                                    {{else:}}
                                    <select name="search_status" id="search_status" style="width:100px; height: 30px;">
                                        <option value="Draft" {{='selected' if session.search_status == 'Draft' else ''}}>Draft</option>
                                        <option value="Submitted" {{='selected' if session.search_status == 'Submitted' else ''}}>Submitted</option>
                                        <option value="Cancel" {{='selected' if session.search_status == 'Cancel' else ''}}>Cancel</option>
                                    </select>
                                    {{pass}}
                                </td>
                                <td width="100" >
                                
                                <input type="submit" name="btn_filter_order" id="btn_filter_order" value="Filter" style="border-radius: 4px; height: 30px;" class="button_update"/>
                                <input type="submit" name="btn_all" id="btn_all" value="All" style="border-radius: 4px; height: 30px;" class="button_update"/>
                                  </td>
                                 
                                {{if session.user_type == "Admin" or session.user_type == "ADMIN" or session.user_type == "ADMIN":}}
                               <!-- <td align="right" hidden > -->
                               <td align="right"  >
                               <a href="{{=URL(c='web_order',f='new_web_order_entry',vars=dict(req_sl=last_order_sl))}}">
                                      <input type="button" name="btn_download" id="btn_download" value="+ New Order" style="border-radius: 4px; height: 30px;" class="button_update"/>
                                     </a> 
                               {{pass}}
                                {{if session.user_type == "User" or session.user_type == "USER" or session.user_type == "user":}}
                               <td align="right" >
                               <a href="{{=URL(c='web_order',f='new_web_order_entry',vars=dict(req_sl=last_order_sl))}}">
                                      <input type="button" name="btn_download" id="btn_download" value="+ New Order" style="border-radius: 4px; height: 30px;" class="button_update"/>
                                     </a> 
                               {{pass}}
                               </td>
                             </tr>
                            </form>
                        </table>
                        <strong>Total:</strong> {{=total_rec}}<br />
                        
                        <!--======END=========-->


                        <!--=========SHOW TABLE========-->
                        <table width="80%" border="1" cellpadding="1" cellspacing="1" class="sample_border" >
                            <tr align="left" class="blackCatHead"  height="20px" ;"vertical-align:middle" style="background-color: #c4e3ec">
                          
                            <td width="50" >VSL</td>
                            <td width="60" >B.O.SL</td>
                            <td  >Name</td>
                            <td width="110"  >Mobile</td>
                            <td width="120"  >Address</td>
                            <td width="120"  >Order Date</td>
                            <td width="120"  >Status</td>
                            
                            <td width="50"  >&nbsp;</td>
                              
                            </tr>
                            {{if len(itemRows)>0:}}
                                {{for records_ov_dict in itemRows:
                                    id=str(records_ov_dict["id"])
                                    item_sl=str(records_ov_dict["sl"])
                                    client_name=str(records_ov_dict["client_name"])
                                    area_name=str(records_ov_dict["area_name"])
                                    mobile_no=str(records_ov_dict["mobile_no"])
                                    status=str(records_ov_dict["status"])              
                                    order_date=str(records_ov_dict["order_date"])              
                                    address=str(records_ov_dict["level3_name"])              
                                }}
                                
                                <tr  align="left" class="blackCat"  style=" font-size:13px"> 
                                    

                                    <td width="50" >{{=id}}</td>
                                    
                                    <td width="60" style="background-color:#F4F5C5">{{=item_sl}}</td>
                                    
                                    <td  align="left"  >{{=client_name}}</td>
                                    
                                    <td width="110" >{{=mobile_no}}</td>
                                    <!-- address -->
                                    <td width="110" >{{=address}}</td>     
                                    <td width="110" >{{=order_date}}</td>     
                                    

                                    <td width="70" align="center"  >{{=status}}</td>
                                    
                                  
                                    <td width="50" align="right">
                                        <a href="{{=URL(c='order',f='order_details',vars=dict(req_sl=item_sl),args=[page])}}">
                                                <input type="button" name="btn_detail" id="btn_detail" value="Order &gt;"  class="button_update"/>
                                        </a>                        
                                    </td>
                                
                                </tr>
                                {{pass}}
                            {{pass}}

                            
                        </table>

                        {{if page:}}
                        &nbsp;&nbsp;<a href="{{=URL(args=[page-page])}}">first</a> |
                        &nbsp;&nbsp;<a href="{{=URL(args=[page-1])}}">previous</a> |
                        {{pass}}
                        
                        {{if len(itemRows)>items_per_page:}}
                        &nbsp;&nbsp;<a href="{{=URL(args=[page+1])}}">next</a>
                        {{pass}}
                    </td>
                </tr>
            </table>
        </td>
    </tr>
</table>

                            
